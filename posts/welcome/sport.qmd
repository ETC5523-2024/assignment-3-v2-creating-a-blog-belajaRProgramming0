---
title: "The Pattern of Olympic Athletes' Peak and Average Age by Primary Attributes"
description: |
  An analysis on relationship between sports' main attribute requirement with their athletes' peak performance age.
date: "2024-09-04"
categories: [olympic, sport, R]
title-block-banner: false
format:
  html:
    toc: true
    toc_float: true
    fig-align: center
    number-sections: false
---

```{r, echo=FALSE}
knitr::opts_chunk$set(
  echo = FALSE,   # Hide the code in all chunks
  results = 'show', # Show all output
  message = FALSE,  # Hide messages
  warning = FALSE   # Hide warnings
)

# YAML tambahin option biar ganti warna title, kasih highlight, kurangin opacity banner nya.

```


![Men's Speed Climbing Gold Medalist of Olympics 2024, Veddriq Leonardo, (8/8/2024). ANTARA FOTO/Wahyu Putro A.](images/veddriq.png){width=800, height=400}


# Executive Summary

This report analyses the relationship between the peak and average ages of Olympic athletes across various sports, categorised by primary attributes like **flexibility**, **endurance**, **analytic aptitude** and more. Using data from ESPN’s toughest sports rankings and Olympic data spanning 1948 to 2016, the findings reveal how these attributes influence athletes’ career longevity. Specifically, sports relying on flexibility tend to see peak performances in athletes in their early 20s, whereas sports requiring strong analytic aptitude have athletes peaking closer to their 30s. These insights are valuable for optimising training strategies and athlete development programs for both aspiring Olympians and sports stakeholders.


# Introduction

The Olympic Games highlight athletes’ peak physical and mental performances across various disciplines. This report examines patterns in the peak and average ages of Olympians, exploring how attributes like flexibility, nerve, endurance, and analytic aptitude shape these trends. Understanding these patterns can help refine coaching strategies, optimise training programs, and extend athletes' careers. Grouping sports by their primary attributes offers new insights into how both physical and mental demands influence career trajectories.

The age at which athletes peak varies greatly depending on the sport and its required attributes. This knowledge is valuable for aspiring Olympians and those guiding athletes, helping them identify when to begin focused training and prepare for competition. It also aids coaches and trainers in designing more effective regimens, ensuring athletes reach their full potential at the optimal time.


# Methods

The analysis combines two datasets:

1. ESPN Toughest Sports: This dataset ranks 60 sports across 10 skill categories: **endurance (END)**, **strength (STR)**, **power (PWR)**, **speed (SPD)**, **agility (AGI)**, **flexibility (FLX)**, **nerve (NER)**, **durability (DUR)**, **hand-eye coordination (HAN)**, **analytic aptitude (ANA)**. Each category reflects the unique demands placed on athletes in their respective sports, allowing for a comprehensive understanding of how these attributes correlate with age.

2. Olympic Data: This dataset is collected from Kaggle, from user Bhanupratap Biswas, includes information on every athlete who competed in the Olympics from the 1896 edition to the 2016 edition summer and winter. The analysis focuses on data from 1948-2016 to align with the era of the _modern olympics games._

3. Data Processing Steps: Read raw dataset; cleaning symbols, unused variable, name manipulation; join the two data; plotting.

_Note: Complete data dictionary is available in Appendix A, involving all variables._

# Results and Analysis

```{r, Loading Dataset and view the data, results='hide'}
library(tidyverse)
library(visdat)
library(summarytools)

oly_data <- read_csv("data/dataset_olympics.csv") |>
  select(-Medal, -Games, -ID, -Season) |>
  filter(Year >= 1948) |> 
  drop_na()

glimpse(oly_data)

#dfSummary(oly_data) # nanti hapus

```


```{r Modify oly data, results='hide'}
library(dplyr)

oly_data1 <- oly_data |>
  # Rename specific sports
  mutate(Sport = case_when(
    Sport == "Luge" ~ "Bobsleigh",
    Sport == "Skeleton" ~ "Bobsleigh",
    Sport == "Taekwondo" ~ "Martial Arts",
    Sport == "Judo" ~ "Martial Arts",
    Sport == "Softball" ~ "Baseball",
    Sport == "Short Track Speed Skating" ~ "Speed Skating",
    TRUE ~ Sport)) |>
  # Use regex to rename based on "Event" column
  mutate(Sport = case_when(
    grepl("Pole Vault", Event) & Sport == "Athletics" ~ "Athletics_PoleVault",
    grepl("High Jump", Event) & Sport == "Athletics" ~ "Athletics_HighJumps",
    grepl("Throw|Shot Put", Event) & Sport == "Athletics" ~ "Athletics_Weights",
    grepl("100|110|200|400", Event) & Sport == "Athletics" ~ "Athletics_Sprints",
    grepl("800|1,500|3,000", Event) & Sport == "Athletics" ~ "Athletics_MidDistance",
    grepl("5,000|10,000", Event) & Sport == "Athletics" ~ "Athletics_LongDistance",
    grepl("Sprint", Event) & Sport == "Cycling" ~ "Cycling_Sprints",
    grepl("50 metres|100 metres", Event) & Sport == "Swimming" ~ "Swimming_Sprints",
    TRUE ~ Sport)) |>
  mutate(Sport = case_when(
    Sport == "Swimming" ~ "Swimming_Distance",
    Sport == "Cycling" ~ "Cycling_Distance",
    TRUE ~ Sport)) |>
  mutate(Sport = case_when(
    grepl("Jump", Event) & Sport == "Athletics" ~ "Athletics_Jumps",
    TRUE ~ Sport)) |>
  mutate(Sport = case_when(
    Sport == "Athletics" ~ "Athletics_LongDistance", TRUE ~ Sport))

# View updated data
head(oly_data1, 5)

#write.csv(oly_data1, "data/oly_data1.csv")

```


```{r looking at the data, results='hide'}
library(readxl)
library(dplyr)

oly_byyear <- oly_data1 |> 
  group_by(Year) |>
  distinct(Sport)

# Read the data and rename the SPORT column
attr_data <- read_xlsx("data/toughestsport_attributes.xlsx") |>
  mutate(SPORT = case_when(
    SPORT == "Skiing: Alpine" ~ "Alpine Skiing",
    SPORT == "Skiing: Freestyle" ~ "Freestyle Skiing",
    SPORT == "Racquetball/Squash" ~ "Racquets",
    SPORT == "Track and Field: Pole Vault" ~ "Athletics_PoleVault",
    SPORT == "Track and Field: High Jump" ~ "Athletics_HighJumps",
    SPORT == "Track and Field: Long, Triple jumps" ~ "Athletics_Jumps",
    SPORT == "Track and Field: Distance" ~ "Athletics_LongDistance",
    SPORT == "Track and Field: Middle Distance" ~ "Athletics_MidDistance",
    SPORT == "Track and Field: Sprints" ~ "Athletics_Sprints",
    SPORT == "Track and Field: Weights" ~ "Athletics_Weights",
    SPORT == "Football" ~ "footballz",
    SPORT == "Soccer" ~ "Football",
    SPORT == "Field Hockey" ~ "Hockey",
    SPORT == "Team Handball" ~ "Handball",
    SPORT == "Canoe/Kayak" ~ "Canoeing",
    SPORT == "Weight-Lifting" ~ "Weightlifting",
    SPORT == "Bobsledding/Luge" ~ "Bobsleigh",
    SPORT == "Equestrian" ~ "Equestrianism",
    SPORT == "Cycling: Distance" ~ "Cycling_Distance",
    SPORT == "Cycling: Sprints" ~ "Cycling_Sprints",
    SPORT == "Baseball/Softball" ~ "Baseball",
    SPORT == "Bobsledding/Lugo" ~ "Bobsleigh",
    SPORT == "Swimming (all strokes): Distance" ~ "Swimming_Distance",
    SPORT == "Swimming (all strokes): Sprints" ~ "Swimming_Sprints",
    SPORT == "Cycling: Sprints" ~ "Cycling_Sprints",
    SPORT == "Skiing: Nordic" ~ "Nordic Combined",
    TRUE ~ SPORT)) |>
  rename(`Sport` = `SPORT`) |>
  filter(Sport != "footballz")

# Display the renamed data
head(attr_data, 5)

#write.csv(attr_data, "data/attrdata.csv")
```

```{r Creating Top 3 Attributes per Sport Category}
# Pivot longer
attr_long <- attr_data |>
  select(-TOTAL, -RANK) |>
  pivot_longer(cols = -Sport, names_to = "attr", values_to = "values")


# Rank and select top 3 attributes for each sport
top_attrs <- attr_long %>%
  group_by(Sport) %>%
  arrange(desc(values)) %>%
  slice_head(n = 3) %>%
  mutate(rank = row_number()) %>%
  select(Sport, attr, values, rank)


# Pivot wider to get top 3 attributes in separate columns
attr_top_wide <- top_attrs %>%
  pivot_wider(names_from = rank, values_from = c(attr, values), names_sep = "_") %>%
  rename(
    Top_1_attr = attr_1, Top_1_value = values_1,
    Top_2_attr = attr_2, Top_2_value = values_2,
    Top_3_attr = attr_3, Top_3_value = values_3)

```




```{r, results='hide'}
oly_attr_join <- left_join(oly_data1, attr_top_wide, by = "Sport") |> drop_na()

#write.csv(oly_attr_join, "data/oly_final.csv")

glimpse(oly_attr_join)
```

The way we want to extract information in this report is by using two plots, one for the overall average age of each sports attrbute and following by showing the boxplot to see the distribution of each sport category faceted by sport attribute, we will analyse the trend and dig deeper into some sports category with interesting pattern.


```{r}
#| label: tbl-avgage
#| tbl-cap: Average Age of Athletes per Sports' Primary Attribute.

library(kableExtra)

# Create a named vector for attribute names
attribute_names <- c("END" = "Endurance", 
                     "STR" = "Strength", 
                     "PWR" = "Power", 
                     "SPD" = "Speed", 
                     "AGI" = "Agility", 
                     "FLX" = "Flexibility", 
                     "NER" = "Nerve", 
                     "DUR" = "Durability", 
                     "HAN" = "Hand-eye Coordination", 
                     "ANA" = "Analytic Aptitude")

# Update the pipeline to include attribute name mapping
n <- oly_attr_join |>
  select(Age, Sport, Top_1_attr) |>
  group_by(Top_1_attr) |>
  summarise(Average_Age_years = round(mean(Age), 0)) |>  # Round Average_Age to integer
  mutate(Primary_Attribute = Top_1_attr,                 # Rename Top_1_attr to Primary_Attribute
         Attribute_Full = 
           attribute_names[Top_1_attr]) |>               # Add full attribute names
  select(-Top_1_attr) |>                                 # Remove Top_1_attr column
  relocate(Average_Age_years, .after = last_col()) |>    # Relocate Average_Age_years to the right
  arrange(desc(Average_Age_years))

# Print the table with caption and styling
n |>
  kable(caption = "Average Age of Athletes per Sports' Primary Attribute.", 
        align = 'c') |>  # Center align the columns
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"), 
                full_width = FALSE, 
                position = "center",
                font_size = 10) |>  # Reduce font size
  row_spec(0, bold = TRUE, color = "white", background = "#4CAF50") |>  # Header row style
  column_spec(1, bold = TRUE)  # Make the first column bold

```


@tbl-avgage shows the average age of athletes per sports’ primary attribute. Sports requiring _Flexibilty_ tend to have participant of the averaging at the early 20s, while those requiring _Analytical Aptitude,_ reached 32 years old.

In order to get more insight, boxplot is choosen due to its ability to contain information such as Median, Average, Inter quartile range, and outliers. These features allows us to see the Peak Age and Career longevity of each sports.


```{r Top 1 Attributes, warning=FALSE}
#| label: fig-boxplottop1attr
#| fig-cap: Age Distribution by Top Attributes (Endurance, Power, Speed, Agility).

library(ggplot2)
library(patchwork)
library(cowplot)

# Create the boxplot for Top_1_attr = END
p1 <- ggplot(oly_attr_join %>% filter(Top_1_attr == "END"), aes(x = Sport, y = Age)) +
  geom_boxplot() +
  scale_y_continuous(breaks = seq(20, 60, by = 2)) +
  labs(title = "END",
       x = "Sport",
       y = "Age") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

# Create the boxplot for Top_1_attr = STR
p2 <- ggplot(oly_attr_join %>% filter(Top_1_attr == "STR"), aes(x = Sport, y = Age)) +
  geom_boxplot() +
  scale_y_continuous(breaks = seq(20, 60, by = 2)) +
  labs(title = "STR",
       x = "Sport",
       y = "Age") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

# Create the boxplot for Top_1_attr = PWR
p3 <- ggplot(oly_attr_join %>% filter(Top_1_attr == "PWR"), aes(x = Sport, y = Age)) +
  geom_boxplot() +
  scale_y_continuous(breaks = seq(20, 60, by = 2)) +
  labs(title = "PWR",
       x = "Sport",
       y = "Age") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

# Create the boxplot for Top_1_attr = SPD
p4 <- ggplot(oly_attr_join %>% filter(Top_1_attr == "SPD"), aes(x = Sport, y = Age)) +
  geom_boxplot() +
  scale_y_continuous(breaks = seq(20, 60, by = 2)) +
  labs(title = "SPD",
       x = "Sport",
       y = "Age") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

# Create the boxplot for Top_1_attr = AGI
p5 <- ggplot(oly_attr_join %>% filter(Top_1_attr == "AGI"), aes(x = Sport, y = Age)) +
  geom_boxplot() +
  scale_y_continuous(breaks = seq(20, 60, by = 2)) +
  labs(title = "AGI",
       x = "Sport",
       y = "Age") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

# Create the boxplot for Top_1_attr = FLX
p6 <- ggplot(oly_attr_join %>% filter(Top_1_attr == "FLX"), aes(x = Sport, y = Age)) +
  geom_boxplot() +
  scale_y_continuous(breaks = seq(20, 60, by = 2)) +
  labs(title = "FLX",
       x = "Sport",
       y = "Age") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

# Create the boxplot for Top_1_attr = NER
p7 <- ggplot(oly_attr_join %>% filter(Top_1_attr == "NER"), aes(x = Sport, y = Age)) +
  geom_boxplot() +
  scale_y_continuous(breaks = seq(20, 60, by = 2)) +
  labs(title = "NER",
       x = "Sport",
       y = "Age") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

# Create the boxplot for Top_1_attr = DUR
p8 <- ggplot(oly_attr_join %>% filter(Top_1_attr == "DUR"), aes(x = Sport, y = Age)) +
  geom_boxplot() +
  scale_y_continuous(breaks = seq(20, 60, by = 2)) +
  labs(title = "DUR",
       x = "Sport",
       y = "Age") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

# Create the boxplot for Top_1_attr = HAN
p9 <- ggplot(oly_attr_join %>% filter(Top_1_attr == "HAN"), aes(x = Sport, y = Age)) +
  geom_boxplot() +
  scale_y_continuous(breaks = seq(20, 60, by = 2)) +
  labs(title = "HAN",
       x = "Sport",
       y = "Age") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

# Create the boxplot for Top_1_attr = ANA
p10 <- ggplot(oly_attr_join %>% filter(Top_1_attr == "ANA"), aes(x = Sport, y = Age)) +
  geom_boxplot() +
  scale_y_continuous(breaks = seq(20, 60, by = 2)) +
  labs(title = "ANA",
       x = "Sport",
       y = "Age") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

# Combine the plots in a 5x2 grid
combined_plot1 <- (p1 | p3 | p4 | p5) +
                 plot_layout(widths = c(8, 8, 5, 3)) +
                 plot_annotation(title = "Age Distribution by Top Attributes",
                   theme = theme(
                     plot.title = element_text(
                       hjust = 0.5, face = "bold", size = 13)
                   )
                 )

combined_plot2 <- (p6 | p7 | p9 | p10) +
  plot_layout(widths = c(4, 5, 7, 2))  


combined_plot3 <- p2 + p8 


# Display the combined plot
print(combined_plot1)

```


```{r}
#| label: fig-boxplottop1attr2
#| fig-cap: Age Distribution by Top Attributes (Flexibility, Nerve, Handling, Analytics).

print(combined_plot2)
```

```{r}
#| label: fig-boxplottop1attr3
#| fig-cap: Age Distribution by Top Attributes (Strength and Durability).

print(combined_plot3)

```

The analysis further reveals that sports relying on endurance and nerve also see higher average ages, indicating longer careers for athletes in these disciplines.

Athletics, even though categorised as one by the olympic body (IOC), in reality has different primary attribute demands according to the events. For example, _Athletics_LongDistance_ in @fig-boxplottop1attr that includes sport disciplines of more than 3.000 m distance requires **endurance** the most, in contrast to majority of other athletics category require **power** the most.

Looking at each primary attribute categories, interestingly, _Shooting_ and _Equestrianism_ on @fig-boxplottop1attr2 has the age distribution much older than its friend in the same category, reaching 30s. This means that to become an athlete of the

Sports that primarily rely on Analytics skill, tend to have longer career span, of more than 10 years. This number is way above average of 4-5 years in other categories (seen on three figures), excluding sports with main attribute of _Handling._


# Conclusion

The analysis reveals distinct age patterns among Olympic athletes, with younger athletes excelling in flexibility-driven sports and older athletes performing better in analytical and nerve-based disciplines. By examining data from the ESPN Toughest Sports rankings and Olympic data from 1948 to 2016, we can appreciate the diverse demands of different sports and the unique career trajectories of Olympic athletes. The analysis of peak and average ages further highlights how the primary attributes required for success—such as flexibility, nerve, and analytic aptitude—shape these patterns, with younger athletes dominating flexibility-based sports and older athletes excelling in more mentally demanding disciplines.

These insights underscore the need for tailored training programs that align with athletes’ physiological development and the specific demands of their sports, thereby enhancing performance and extending athletic careers. By recognizing these patterns, coaches, trainers, and other stakeholders in the sports community can better support athletes’ development, ensuring that they reach their full potential at the right time. Career longevity is also an important consideration when selecting which sports to pursue, and understanding these patterns helps optimize training strategies and career planning for all involved in an athlete’s journey.

\newpage

# References

ESPN. (2021). Degree of difficulty: Ranking the toughest sports. ESPN. Retrieved from [https://www.espn.com/espn/page2/sportSkills](https://www.espn.com/espn/page2/sportSkills)

De Bosscher, V., Descheemaeker, K., & Shibli, S. (2023). Starting and specialisation ages of elite athletes across Olympic sports: An international cross-sectional study. European Journal of Sport Sciences. [https://doi.org/10.24018/ejsport.2023.2.5.100](https://doi.org/10.24018/ejsport.2023.2.5.100)

Longo, A. F., Siffredi, C. R., Cardey, M. L., Aquilino, G. D., & Lentini, N. A. (2020). Age of peak performance in Olympic sports: A comparative research among disciplines. Journal of Sports Sciences, 11(1), 141-152. [https://doi.org/10.14198/jhse.2016.111.03](https://doi.org/10.14198/jhse.2016.111.03)

